<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Class Moanin — Moanin-class • moanin</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Class Moanin — Moanin-class" />
<meta property="og:description" content="Moanin is a class that extends
  SummarizedExperiment and is used to store the additional spline
  basis and meta data for timecourse analysis.
In addition to the slots of the SummarizedExperiment
class, the Moanin object has the additional slots described
in the Slots section.
There are several methods implemented for this class. The most
  important methods have their own help page. Simple helper methods are
  described in the Methods section below. For a comprehensive list of methods
  specific to this class see the Reference Manual.
The constructor create_moanin_model creates an object of
 the class Moanin." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">moanin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0-901</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/documentation.html">moanin package</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Class Moanin</h1>
    
    <div class="hidden name"><code>Moanin-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>Moanin</code> is a class that extends
  <code>SummarizedExperiment</code> and is used to store the additional spline
  basis and meta data for timecourse analysis.</p>
<p>In addition to the slots of the <code>SummarizedExperiment</code>
class, the <code>Moanin</code> object has the additional slots described
in the Slots section.</p>
<p>There are several methods implemented for this class. The most
  important methods have their own help page. Simple helper methods are
  described in the Methods section below. For a comprehensive list of methods
  specific to this class see the Reference Manual.</p>
<p>The constructor <code>create_moanin_model</code> creates an object of
 the class <code>Moanin</code>.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for DataFrame</span>
<span class='fu'>create_moanin_model</span>(<span class='no'>data</span>, <span class='no'>meta</span>, <span class='no'>...</span>)

<span class='co'># S4 method for data.frame</span>
<span class='fu'>create_moanin_model</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for matrix</span>
<span class='fu'>create_moanin_model</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>create_moanin_model</span>(
  <span class='no'>data</span>,
  <span class='kw'>spline_formula</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>basis_matrix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>group_variable_name</span> <span class='kw'>=</span> <span class='st'>"Group"</span>,
  <span class='kw'>time_variable_name</span> <span class='kw'>=</span> <span class='st'>"Timepoint"</span>,
  <span class='kw'>degrees_of_freedom</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>log_transform</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>drop_levels</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>The input data. Can be a <code>SummarizedExperiment</code> class,
or matrix/data.frame. If the input data is a <code>matrix</code> or
<code>data.frame</code>, then the user must also provide input to the <code>meta</code>
argument, which will be transformed into <code>colData</code> of the resulting
<code>Moanin</code> object</p></td>
    </tr>
    <tr>
      <th>meta</th>
      <td><p>Meta data on the samples (columns) of the <code>data</code> argument.
Must be given f input <code>data</code> is a <code>matrix</code> or <code>data.frame</code>.
If input is <code>SummarizedExperiment</code>, this argument is ignored.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed from methods to the <code>SummarizedExperiment</code>
method.</p></td>
    </tr>
    <tr>
      <th>spline_formula</th>
      <td><p>formula object, optional, default: NUlL. Used to
construct splines from the data in <code>meta</code>. See details.</p></td>
    </tr>
    <tr>
      <th>basis_matrix</th>
      <td><p>matrix, optional, default: NULL. A basis matrix, where
each row corresponds to the evaluation of a sample on the basis function
(thus one column for each basis function).</p></td>
    </tr>
    <tr>
      <th>group_variable_name</th>
      <td><p>A character value giving the column that
corresponds to the grouping variable to test for DE. By default "Group"</p></td>
    </tr>
    <tr>
      <th>time_variable_name</th>
      <td><p>A character value giving the column that corresponds
to the time variable. By default "Timepoint".</p></td>
    </tr>
    <tr>
      <th>degrees_of_freedom</th>
      <td><p>int, optional. Number of degrees of freedom to use
if neither the basis_matrix nor the spline_formula is provided. If not
provided by the user, internally will be set to 4</p></td>
    </tr>
    <tr>
      <th>log_transform</th>
      <td><p>whether the data should be log-transformed by certain
methods (see <code><a href='splines_kmeans.html'>splines_kmeans</a></code>)</p></td>
    </tr>
    <tr>
      <th>drop_levels</th>
      <td><p>Logical, whether to perform <code><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></code> on the
grouping variable (i.e. remove empty levels)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>Moanin</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If neither <code>spline_formula</code> nor <code>basis_matrix</code> is given,
 then by default, the function will create a basis matrix based on the
 formula:</p><pre><span class='no'>spline_formula</span> <span class='kw'>=</span> ~<span class='no'>Group</span>:<span class='fu'>ns</span>(<span class='no'>Timepoint</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>4</span>) + <span class='no'>Group</span> +
 <span class='fl'>0</span></pre>

<p>Note that the meta data will have levels dropped (via 
<code>droplevels</code>).</p>
<p>Input to <code>data</code> that is given as a class <code>matrix</code> or
 <code>data.frame</code> will be converted to class <code>DataFrame</code>. The reason
 for this is that <code>DataFrame</code> allows replicate row names, while
 <code>data.frame</code> does not. Therefore use of a <code>data.frame</code> becomes a
 problem if bootstrapping the genes, as you will get replicate rows and hence
 replicate row names. Users who absolutely want the object to hold a
 non-DataFrame object can construct a <code>SummarizedExperiment</code> object
 (which will not convert the matrix-like object into a <code>DataFrame</code>), and
 use this as input to <code>create_moanin_model</code>.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl'>
<dt><code>time_variable_name</code></dt><dd><p>character value giving the column in <code>colData</code>
that defines the time variable (must be of class <code>numeric</code>)</p></dd>

<dt><code>group_variable_name</code></dt><dd><p>character value giving the column in <code>colData</code>
that defines the grouping variable (must be of class <code>factor</code>)</p></dd>

<dt><code>basis_matrix</code></dt><dd><p>A basis matrix, where each row corresponds to the
evaluation of a sample on the basis function (thus one column for each
basis function).</p></dd>

<dt><code>spline_formula</code></dt><dd><p>a formula. The formula used in creating the basis matrix</p></dd>

<dt><code>degrees_of_freedom</code></dt><dd><p>a numeric integer. Number of degrees of freedom used
in creating basis matrix. If NULL, degrees of freedom is not known (usually
if user provided basis without degrees of freedom)</p></dd>

<dt><code>log_transform</code></dt><dd><p>logical, whether to log-transform the data for certain
methods</p></dd>

</dl>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load some data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>exampleData</span>)

<span class='co'># Use the default options</span>
<span class='no'>moanin</span> <span class='kw'>=</span> <span class='fu'>create_moanin_model</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>testData</span>,<span class='kw'>meta</span><span class='kw'>=</span><span class='no'>testMeta</span>)
<span class='no'>moanin</span></div><div class='output co'>#&gt; Moanin object on 126 samples containing the following information:
#&gt; Group variable given by 'Group' with the following levels:
#&gt;  C  K  M 
#&gt; 42 42 42 
#&gt; Time variable given by 'Timepoint'
#&gt; Basis matrix with 15 basis_matrix functions
#&gt; Basis matrix was constructed with the following spline_formula
#&gt; ~Group + Group:splines::ns(Timepoint, df = 4) + 0 
#&gt; 
#&gt; Information about the data (a SummarizedExperiment object):
#&gt; class: SummarizedExperiment 
#&gt; dim: 500 126 
#&gt; metadata(0):
#&gt; assays(1): ''
#&gt; rownames(500): NM_009912 NM_008725 ... NM_001163774 NM_026944
#&gt; rowData names(0):
#&gt; colnames(126): GSM1557140 GSM1557141 ... GSM1557264 GSM1557265
#&gt; colData names(5): '' Group Replicate Timepoint WeeklyGroup</div><div class='input'>
<span class='co'># Change the number of degrees of freedom</span>
<span class='no'>moanin</span> <span class='kw'>=</span> <span class='fu'>create_moanin_model</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>testData</span>,<span class='kw'>meta</span><span class='kw'>=</span><span class='no'>testMeta</span>,
   <span class='kw'>degrees_of_freedom</span><span class='kw'>=</span><span class='fl'>6</span>)
<span class='no'>moanin</span></div><div class='output co'>#&gt; Moanin object on 126 samples containing the following information:
#&gt; Group variable given by 'Group' with the following levels:
#&gt;  C  K  M 
#&gt; 42 42 42 
#&gt; Time variable given by 'Timepoint'
#&gt; Basis matrix with 21 basis_matrix functions
#&gt; Basis matrix was constructed with the following spline_formula
#&gt; ~Group + Group:splines::ns(Timepoint, df = 6) + 0 
#&gt; 
#&gt; Information about the data (a SummarizedExperiment object):
#&gt; class: SummarizedExperiment 
#&gt; dim: 500 126 
#&gt; metadata(0):
#&gt; assays(1): ''
#&gt; rownames(500): NM_009912 NM_008725 ... NM_001163774 NM_026944
#&gt; rowData names(0):
#&gt; colnames(126): GSM1557140 GSM1557141 ... GSM1557264 GSM1557265
#&gt; colData names(5): '' Group Replicate Timepoint WeeklyGroup</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://nellev.github.io/'>Nelle Varoquaux</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


